<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"
        integrity="sha512-5A8nwdMOWrSz20fDsjczgUidUBR8liPYU+WymTZP1lmY9G6Oc7HlZv156XqnsgNUzTyMefFTcsFH/tnJE/+xBg=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Ubuntu:ital,wght@0,300;0,400;0,500;0,700;1,300;1,400;1,700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css" />

    <!-- cdn font-awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
        integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css"
        integrity="sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI=" crossorigin="" />

    <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"
        integrity="sha256-WBkoXOwTeyKclOHuWtc+i2uENFpDZ9YPdf5Hf+D7ewM=" crossorigin=""></script>

    <script src="points.js"></script>
    <script src="assets/js/leaflet-knn.js"></script>

    <link rel="stylesheet" href="style.css">
    <title>Morrocan Travel Agency</title>
</head>

<body>
    <!-- Start spinner -->
    <div id="spinner" class="spinner-wrapper justify-content-center align-items-center"></div>
    <!-- End spinner -->

    <!-- Start Header -->
    <header id="header"></header>
    <!-- End header -->

    <!-- Start Hero Section -->
    <div id="hero"></div>
    <!-- End Hero Section -->

    <!-- Start About Section -->
    <div id="about"></div>
    <!-- End About Section -->

    <!-- Start Destinations Section -->
    <div id="destinations"></div>
    <!-- End Destinations Section -->

    <!-- Start mapNearly Section -->
    <div id="mapNearly">
        <section class="bg-secondary-020 py-40">
            <div class="container">
                <div class="row">
                    <div class="col-12 text-center mb-5">
                        <p class="text-primary fw-bold py-2">Hotels in close proximity to my location</p>
                        <h4 class="">Hotels in close proximity to my location in Morocco, including various amenities
                            and
                            accommodation options, await your stay.</h4>
                    </div>
                </div>
                <div class="row cards-wrapper mb-5">
                    <div class="col-12" id="map">

                    </div>
                </div>
            </div>
        </section>
    </div>
    <!-- End mapNearly Section -->

    <!-- Start packages Section -->
    <div id="packages"></div>
    <!-- End Testimonial Section -->

    <!-- Start Testimonial Section -->
    <div id="testimonial"></div>
    <!-- End Testimonial Section -->

    <!-- Start Blog Section -->
    <div id="blog"></div>
    <!-- End Blog Section -->

    <!-- Start Newslettre Section -->
    <div id="newslettre"></div>
    <!-- End Newslettre Section -->

    <!-- Start Footer Section -->
    <div id="footer"></div>
    <!-- End Footer Section -->

    <script src="pageLoader.js"></script>
    <script>
        // Load the sections using the pageLoader.js
        loadSection('spinner', 'components/spinner.html');
        loadSection('header', 'components/header.html');
        loadSection('hero', 'components/hero.html');
        loadSection('about', 'components/about.html');
        loadSection('destinations', 'components/destinations.html');
        // loadSection('mapNearly', 'components/mapNearly.html');
        loadSection('packages', 'components/packages.html');
        loadSection('testimonial', 'components/testimonial.html');
        loadSection('blog', 'components/blog.html');
        loadSection('newslettre', 'components/newslettre.html');
        loadSection('footer', 'components/footer.html');
        // loadSection('footer', 'footer.html');
    </script>
    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>


    <script src="scripts.js"></script>
    <script src="script-destinations.js"></script>

    <script>

        const map = L.map('map');
        // Initializes map

        var points = L.geoJSON(points).addTo(map);
        pointIndex = leafletKnn(points)

        map.setView([34.0198661,-6.8255744], 12);
        // Sets initial coordinates and zoom level

        L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 18,
            attribution: ''
        }).addTo(map);
        // Sets map data source and associates with map

        let marker, circle, zoomed;

        navigator.geolocation.watchPosition(success, error);

        function success(pos) {

            console.log(pos);

            const lat = pos.coords.latitude;
            const lng = pos.coords.longitude;
            const accuracy = pos.coords.accuracy;

            if (marker) {
                map.removeLayer(marker);
                map.removeLayer(circle);
            }
            // Removes any existing marker and circule (new ones about to be set)

            marker = L.marker([lat, lng]).addTo(map);
            circle = L.circle([lat, lng], { radius: accuracy }).addTo(map);
            // Adds marker to the map and a circle for accuracy

            if (!zoomed) {
                zoomed = map.fitBounds(circle.getBounds());
            }
            // Set zoom to boundaries of accuracy circle

            map.setView([lat, lng]);
            // Set map focus to current user position

        }

        function error(err) {
            if (err.code === 1) {
                alert("Please allow geolocation access");
            } else {
                alert("Cannot get current location");
            }
        }
    </script>

</body>

</html>